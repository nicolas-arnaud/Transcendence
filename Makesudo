NAME = transcendence
USER = gavaniwast

all: clean dev

prod:
	sudo docker-compose up --build

dev:
	sudo docker-compose up --build

check:
	sudo NODE_ENV="check" docker-compose run back --build
	sudo NODE_ENV="check" docker-compose run front --build
	sudo docker compose -f docker-compose.yml down 

debug:
	sudo NODE_ENV="debug" BUILDKIT_PROGRESS=plain docker-compose up --build

stop:
	sudo docker-compose down

clean: stop
	sudo docker system prune -f

fclean: stop
	sudo rm -rf */node_modules
	sudo docker system prune -af --volumes

re: fclean dev

.PHONY: all prod dev check debug stop clean fclean re
